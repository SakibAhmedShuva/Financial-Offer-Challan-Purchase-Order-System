<h3 class="font-semibold text-xl mb-4 text-gray-800 dark:text-white flex items-center gap-3"><i class="fas fa-magic text-indigo-500"></i>AI-Powered BOQ Processor</h3>
<p class="text-gray-600 dark:text-gray-400 mb-6">Upload an Excel (XLSX) file containing your Bill of Quantities. The AI will parse the items, find matching products from the database, and allow you to build your final offer, PO, or challan.</p>

<div class="mb-6 p-4 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800/50">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 items-end">
        <div class="lg:col-span-1">
            <label for="ai-file-input" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Upload Your BOQ File</label>
            <div class="flex items-center">
                <input type="file" id="ai-file-input" accept=".xlsx, .xls" class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400">
            </div>
            <p id="ai-file-name-display" class="text-xs text-slate-500 dark:text-slate-400 mt-2 hidden"></p>
        </div>
        
        <div class="lg:col-span-2 grid grid-cols-1 sm:grid-cols-3 gap-x-6 gap-y-4">
            <div>
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Match Sources</label>
                <div class="flex items-center space-x-4 pt-1">
                    <div class="flex items-center">
                        <input id="ai-source-foreign" type="checkbox" value="foreign" class="h-4 w-4 text-sky-600 rounded" checked>
                        <label for="ai-source-foreign" class="ml-2 block text-sm">Foreign</label>
                    </div>
                    <div class="flex items-center">
                        <input id="ai-source-local" type="checkbox" value="local" class="h-4 w-4 text-sky-600 rounded" checked>
                        <label for="ai-source-local" class="ml-2 block text-sm">Local</label>
                    </div>
                </div>
            </div>
            <div>
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Original Price Represents</label>
                 <div class="flex items-center space-x-4 pt-1">
                    <div class="flex items-center">
                        <input id="ai-price-type-local" type="radio" value="local" name="ai_price_type" class="h-4 w-4 text-sky-600">
                        <label for="ai-price-type-local" class="ml-2 block text-sm">Local (BDT)</label>
                    </div>
                    <div class="flex items-center">
                        <input id="ai-price-type-foreign" type="radio" value="foreign" name="ai_price_type" class="h-4 w-4 text-sky-600" checked>
                        <label for="ai-price-type-foreign" class="ml-2 block text-sm">Foreign (USD)</label>
                    </div>
                </div>
            </div>
             <div>
                <label class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Categories for Naming</label>
                <div id="ai-category-checkboxes" class="flex items-center space-x-3 pt-1">
                    </div>
            </div>
        </div>

        <div class="lg:col-span-1 flex justify-start lg:justify-end items-center gap-2 flex-wrap">
            <button id="ai-process-btn" class="px-5 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-gray-400 flex items-center gap-2 transition-all duration-200 shadow-sm"><i class="fas fa-cogs"></i> Process</button>
            <button id="ai-save-btn" class="px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-slate-400 flex items-center gap-2 transition-all duration-200 shadow-sm" disabled><i class="fas fa-save"></i> Save</button>
            <button id="ai-save-as-btn" class="px-5 py-2.5 bg-sky-600 text-white rounded-lg hover:bg-sky-700 disabled:bg-slate-400 flex items-center gap-2 transition-all duration-200 shadow-sm" disabled><i class="fas fa-copy"></i> Save As</button>
            <button id="ai-clear-btn" class="px-5 py-2.5 bg-gray-500 text-white rounded-lg hover:bg-gray-600 flex items-center gap-2 transition-all duration-200 shadow-sm"><i class="fas fa-times"></i> Clear</button>
        </div>
    </div>
</div>

<div id="ai-results-toolbar" class="hidden my-4 p-4 bg-slate-100 dark:bg-slate-800 rounded-lg flex flex-col sm:flex-row justify-between items-center gap-4">
    <span class="text-sm font-medium text-slate-700 dark:text-slate-300">Processed items are ready.</span>
    <div class="flex items-center space-x-3">
        <span class="text-sm font-medium text-slate-600 dark:text-slate-400">Add to:</span>
        <button id="ai-add-to-offer-btn" class="px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 text-sm font-semibold flex items-center gap-2 transition-all"><i class="fas fa-cogs"></i> Offer</button>
        <button id="ai-add-to-po-btn" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 text-sm font-semibold flex items-center gap-2 transition-all"><i class="fas fa-shopping-cart"></i> PO</button>
        <button id="ai-add-to-challan-btn" class="px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 text-sm font-semibold flex items-center gap-2 transition-all"><i class="fas fa-truck"></i> Challan</button>
    </div>
</div>

<div id="ai-helper-loader" class="text-center py-10 hidden">
    <div class="loader inline-block"></div>
    <p class="mt-2 text-gray-500">Processing your file, please wait...</p>
</div>

<div id="ai-results-container" class="table-container border border-gray-200 dark:border-gray-700 rounded-lg overflow-x-auto">
    <p id="ai-results-placeholder" class="text-center text-gray-500 dark:text-gray-400 py-12">Upload a file and click "Process" to see results here.</p>
</div>